#!/usr/bin/env python3
INF = 10 ** 16
    
# Generated by 2.12.0 https://github.com/kyuridenamida/atcoder-tools  (tips: You use the default template now. You can remove this line by using your custom template)
def main():
    N, M = map(int, input().split())
    A = list(map(int, input().split()))
    dp = [INF] * N
    G = [[] for _ in range(N)]
    for _ in range(M):
        X, Y = map(int, input().split())
        G[X - 1].append(Y - 1)

    for now in range(N):
        for next in G[now]:
            dp[next] = min(dp[next], dp[now], A[now])
    ans = -INF
    for i in range(N):
        ans = max(ans, A[i] - dp[i])
    print(ans)

if __name__ == '__main__':
    main()
