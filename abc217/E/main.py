#!/usr/bin/env python3
import heapq
from collections import deque

# Generated by 2.12.0 https://github.com/kyuridenamida/atcoder-tools  (tips: You use the default template now. You can remove this line by using your custom template)
def main():
    Q = int(input())
    ms = []
    backlog = deque()
    for _ in range(Q):
        qq = list(map(int, input().split()))
        if qq[0] == 1:
            backlog.append(qq[1])
        elif qq[0] == 2:
            if len(ms) > 0:
                ans = heapq.heappop(ms)
            else:
                ans = backlog.popleft()
            print(ans)
        else:
            while len(backlog):
                num = backlog.popleft()
                heapq.heappush(ms, num)
    return

if __name__ == '__main__':
    main()
